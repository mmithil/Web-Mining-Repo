books_training_data <- as.matrix(scale(books_training_data))
class(books_training_set[,2])
class(books_training_set[,1])
apply ( books_training_data, function(x) = as.numeric(x))
apply ( books_training_data, function(x) as.numeric(x))
apply ( books_training_data, fun(x) as.numeric(x))
apply (books_training_data, fun = function(x) as.numeric(x))
apply (books_training_data, FUN = function(x) as.numeric(x))
apply (books_training_data,2, FUN = function(x) as.numeric(x))
books_training_data <- books_training_set[,]
apply (books_training_data,2, FUN = function(x) as.numeric(x))
books_training_data
books_training_data <- as.matrix(scale(books_training_data))
class(books_training_data[,1])
books_training_data <- books_training_set[,]
apply (books_training_data,2, FUN = function(x) as.numeric(x))
class(books_training_data[,1])
apply (books_training_data,2, FUN = function(x) as.numeric(x))
books_training_data <- books_training_set[,]
class(books_training_data[,1])
indx <- sapply(books_training_data, is.factor)
books_training_data[indx] <- lapply(books_training_data[indx],
function(x) as.numeric(as.character(x)))
class(books_training_data[,1])
apply (books_training_data,2, FUN = function(x) as.numeric(x))
books_training_data <- books_training_set[,]
class(books_training_data[,1])
indx <- sapply(books_training_data, is.factor)
books_training_data[indx] <- lapply(books_training_data[indx],
function(x) as.numeric(as.character(x)))
books_training_data <- as.matrix(scale(books_training_data))
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
require(kohonen)
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
?som
plot(som_model, type="count")
som_model <- som(data = books_training_data, grid = som_model )
som_model <- som(data = books_training_data, grid = som_model )
som(data = books_training_data, grid = som_model )
som_model <- som(data = books_training_data, grid = som_grid )
is.na(books_training_data)
books_training_data[is.na(books_training_data)]
books_training_data[,1]
books_training_data[786,1]
books_training_data[786,1]
books_training_set[786,1]
class(books_training_data[,0])
class(books_training_data[1,1])
books_training_data <- books_training_set[1,1]
books_training_data <- books_training_set[,]
indx <- sapply(books_training_data, is.factor)
books_training_data[indx] <- lapply(books_training_data[indx],
function(x) as.numeric(as.character(x)))
books_training_data[indx] <- lapply(books_training_data[indx],
function(x) as.numeric(as.character(x)))
books_training_set <- data.frame(books$text_reviews_count,books$num_pages, books$publication_year,books$average_rating
,books$children, books$religion, books$history, books$math, books$anatology, books$poetry,
books$encyclopedia,books$dictionaries,books$comics,books$art,books$cookbook,books$diaries, books$journals,
books$self.help,books$science.fiction, books$non.fiction)
indx <- sapply(books_training_data, is.factor)
books_training_data[indx] <- lapply(books_training_data[indx],
function(x) as.numeric(as.character(x)))
books_training_data <- as.matrix(scale(books_training_data))
require(kohonen)
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = books_training_data, grid = som_grid )
books_training_data[1,1]
books_training_set <- data.frame(books$text_reviews_count,books$num_pages, books$publication_year,books$average_rating
,books$children, books$religion, books$history, books$math, books$anatology, books$poetry,
books$encyclopedia,books$dictionaries,books$comics,books$art,books$cookbook,books$diaries, books$journals,
books$self.help,books$science.fiction, books$non.fiction)
indx <- sapply(books_training_data, is.factor)
books_training_data[indx] <- lapply(books_training_data[indx],
function(x) as.numeric(as.character(x)))
books_training_data <- as.matrix(scale(books_training_data))
indx <- sapply(books_training_data, is.factor)
books_training_data[indx] <- lapply(books_training_data[indx],
function(x) as.numeric(as.character(x)))
books_training_data <- as.matrix(scale(books_training_data))
books_training_set <- data.frame(books$text_reviews_count,books$num_pages, books$publication_year,books$average_rating
,books$children, books$religion, books$history, books$math, books$anatology, books$poetry,
books$encyclopedia,books$dictionaries,books$comics,books$art,books$cookbook,books$diaries, books$journals,
books$self.help,books$science.fiction, books$non.fiction)
indx <- sapply(books_training_data, is.factor)
books_training_data[indx] <- lapply(books_training_data[indx],
function(x) as.numeric(as.character(x)))
books_training_data <- as.matrix(scale(books_training_data))
books_training_set <- data.frame(books$text_reviews_count,books$num_pages, books$publication_year,books$average_rating
,books$children, books$religion, books$history, books$math, books$anatology, books$poetry,
books$encyclopedia,books$dictionaries,books$comics,books$art,books$cookbook,books$diaries, books$journals,
books$self.help,books$science.fiction, books$non.fiction)
books_training_data <- books_training_set[,]
class(books_training_data[1,1])
class(books_training_data[1,1])
class(books_training_data[1,2])
class(books_training_data[1,3])
class(books_training_data[1,4])
class(books_training_data[1,5])
indx <- sapply(books_training_data, is.factor)
indx
indx <- sapply(books_training_data, is.integer)
indx
books_training_data[indx] <- lapply(books_training_data[indx],
function(x) as.numeric(as.character(x)))
books_training_data <- as.matrix(scale(books_training_data))
books_training_data[is.na(books_training_data)]
require(kohonen)
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = books_training_data, grid = som_grid )
class(books_training_data[1,5])
class(books_training_data[1,])
class(books_training_data[1,20])
class(books_training_data[1,19])
som.wines <- som(scale(books_training_data), grid = somgrid(5, 5, "rectangular"))
SUM(is.na(books_training_data))
ADD(is.na(books_training_data))
sum(is.na(books_training_data))
is.na(books_training_data)
sum(is.na(books_training_set))
books_training_set <- data.frame(books$text_reviews_count,books$num_pages, books$publication_year,books$average_rating
,books$children, books$religion, books$history, books$math, books$anatology, books$poetry,
books$encyclopedia,books$dictionaries,books$comics,books$art,books$cookbook,books$diaries, books$journals,
books$self.help,books$science.fiction, books$non.fiction)
setwd('d:/web mining/project')
books <- read.csv('d:/Web Mining/Project/csv_files/book_data.csv')
colnames(books)
books$published
books_training_set <- data.frame(books$text_reviews_count,books$num_pages, books$publication_year,books$average_rating
,books$children, books$religion, books$history, books$math, books$anatology, books$poetry,
books$encyclopedia,books$dictionaries,books$comics,books$art,books$cookbook,books$diaries, books$journals,
books$self.help,books$science.fiction, books$non.fiction)
indx <- sapply(books_training_data, is.na)
indx
sum(indx)
sum(indx-1)
books_training_set$published
books$published
colnames(books)
books_training_set <- data.frame(books$text_reviews_count,books$num_pages, books$publication_year,books$average_rating
,books$children, books$religion, books$history, books$math, books$anatology, books$poetry,
books$encyclopedia,books$dictionaries,books$comics,books$art,books$cookbook,books$diaries, books$journals,
books$self.help,books$science.fiction, books$non.fiction)
books_training_set$published
books_training_set$publication_year
colnames(books)
books_training_set <- data.frame(books$text_reviews_count,books$num_pages, books$publication_year,books$average_rating
,books$children, books$religion, books$history, books$math, books$anatology, books$poetry,
books$encyclopedia,books$dictionaries,books$comics,books$art,books$cookbook,books$diaries, books$journals,
books$self.help,books$science.fiction, books$non.fiction)
books_training_set$publication_year
books_training_set[:,'publication_year']
books_training_set[,'publication_year']
books_training_set
colnames(books_training_set)
books_training_set[,'books.publication_year']
books_training_set[is.na(books_training_set[,'books.publication_year']) == F,]
books_training_set_mut1<- books_training_set[is.na(books_training_set[,'books.publication_year']) == F,]
books_training_set_mut1$books.publication_year
is.na(books_training_set_mut1)
sum(is.na(books_training_set_mut1))
dim(books_training_data)
books_training_set_mut1
head(books_training_set_mut1)
sum(is.na(books_training_set_mut1))
books_training_data <- books_training_data[complete.cases(books_training_data),]
dim(books_training_data)
books_training_set <- data.frame(books$text_reviews_count,books$num_pages, books$publication_year,books$average_rating
,books$children, books$religion, books$history, books$math, books$anatology, books$poetry,
books$encyclopedia,books$dictionaries,books$comics,books$art,books$cookbook,books$diaries, books$journals,
books$self.help,books$science.fiction, books$non.fiction)
colnames(books_training_set)
books_training_set_mut1<- books_training_set[is.na(books_training_set[,'books.publication_year']) == F,]
books_training_set_mut1$books.publication_year
sum(is.na(books_training_set_mut1))
dim(books_training_data)
books_training_mut1[complete.cases(books_training_mut1),]
books_training_set_mut1[complete.cases(books_training_set_mut1),]
books_training_set_mut1 <- books_training_set_mut1[complete.cases(books_training_set_mut1),]
dim(books_training_set_mut1)
sum(is.na(books_training_set_mut1))
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = books_training_set_mut1, grid = som_grid )
indx <- sapply(sum(books_training_set_mut1, is.integer)
books_training_set_mut1[indx] <- lapply(books_training_set_mut1[indx],
function(x) as.numeric(as.character(x)))
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = books_training_set_mut1, grid = som_grid )
indx <- sapply(sum(books_training_set_mut1, is.integer)
class(books_training_set_mut1[1,19])
indx <- sapply(sum(books_training_set_mut1, is.integer)
;
indx <- sapply(sum(books_training_set_mut1, is.integer)
indx <- sapply(books_training_set_mut1, is.integer)
indx <- sapply(books_training_set_mut1,is.integer)
books_training_set_mut1[indx] <- lapply(books_training_set_mut1[indx],
function(x) as.numeric(as.character(x)))
indx <- sapply(books_training_set_mut1,is.factor)
sum(indx)
books_training_data <- as.matrix(scale(books_training_data))
sum(is.na(books_training_set_mut1))
books_training_set_mut1 <- as.matrix(scale(books_training_set_mut1))
books_training_set_mut1[is.na(books_training_set_mut1)]
indx <- sapply(books_training_set_mut1,is.integer)
sum(indx)
books_training_set_mut1[is.na(books_training_set_mut1)]
books_training_set_mut1[is.na(books_training_set_mut1),]
sum(is.na(books_training_set_mut1)
)
books_training_set_mut1<- books_training_set[is.na(books_training_set[,'books.publication_year']) == F,]
books_training_set_mut1$books.publication_year
sum(is.na(books_training_set_mut1))
complete.cases(books_training_set_mut1)
dim(books_training_set_mut1[complete.cases(books_training_set_mut1),])
books_training_set_mut1 <- books_training_set_mut1[complete.cases(books_training_set_mut1),]
sum(is.na(books_training_set_mut1))
dim(books_training_data)
dim(books_training_set_mut1)
books_training_data <- books_training_set[,]
books_training_data <- books_training_set_mut1[,]
sum(is.na(books_training_data))
class(books_training_set_mut1[1,19])
indx <- sapply(books_training_set_mut1,is.integer)
sum(indx)
books_training_set_mut1[indx] <- lapply(books_training_set_mut1[indx],
function(x) as.numeric(as.character(x)))
books_training_set_mut1 <- as.matrix(scale(books_training_set_mut1))
sum(is.na(books_training_set_mut1))
books <- read.csv('d:/Web Mining/Project/csv_files/book_data.csv')
colnames(books)
books$published
books_training_set <- data.frame(books$text_reviews_count,books$num_pages, books$publication_year,books$average_rating
,books$children, books$religion, books$history, books$math, books$anatology, books$poetry,
books$encyclopedia,books$dictionaries,books$comics,books$art,books$cookbook,books$diaries, books$journals,
books$self.help,books$science.fiction, books$non.fiction)
colnames(books_training_set)
books_training_set_mut1<- books_training_set[is.na(books_training_set[,'books.publication_year']) == F,]
books_training_set_mut1$books.publication_year
sum(is.na(books_training_set_mut1))
head(books_training_set_mut1)
books_training_set_mut1 <- books_training_set_mut1[complete.cases(books_training_set_mut1),]
sum(is.na(books_training_set_mut1))
books_training_data <- books_training_set_mut1[,]
sum(is.na(books_training_data))
indx <- sapply(books_training_set_mut1,is.factor)
sum(indx)
indx <- sapply(books_training_set_mut1,is.integer)
sum(indx)
books_training_set_mut1[indx]
dim(books_training_set_mut1[indx]) <- lapply(books_training_set_mut1[indx],
dim(books_training_set_mut1[indx])
dim(books_training_set_mut1[indx])
dim(books_training_set_mut1[indx])
as.numeric(books_training_set_mut1[indx])
as.numeric(books_training_set_mut1[indx,])
lapply(books_training_set_mut1[indx],
function(x) as.numeric(as.character(x)))
books_training_set_mut1[indx] <- lapply(books_training_set_mut1[indx],
function(x) as.numeric(as.character(x)))
sum(is.na(books_training_set_mut1))
as.matrix(scale(books_training_set_mut1))
books_training_set_mut1 <- is.na(as.matrix(scale(books_training_set_mut1)))
books_training_set_mut1<- books_training_set[is.na(books_training_set[,'books.publication_year']) == F,]
books_training_set_mut1$books.publication_year
sum(is.na(books_training_set_mut1))
head(books_training_set_mut1)
books_training_set_mut1 <- books_training_set_mut1[complete.cases(books_training_set_mut1),]
sum(is.na(books_training_set_mut1))
dim(books_training_set_mut1)
books_training_data <- books_training_set_mut1[,]
sum(is.na(books_training_data))
indx <- sapply(books_training_set_mut1,is.integer)
sum(indx)
books_training_set_mut1[indx] <- lapply(books_training_set_mut1[indx],
function(x) as.numeric(as.character(x)))
sum(is.na(as.matrix(scale(books_training_set_mut1))))
sum(is.na(scale(books_training_set_mut1)))
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
require(kohonen)
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = books_training_set_mut1, grid = som_grid )
sum(indx)
indx <- sapply(books_training_set_mut1,is.integer)
books_training_set_mut1[indx] <- lapply(books_training_set_mut1[indx],
sum(indx)
sum(indx)
books_training_set_mut1[indx] <- lapply(books_training_set_mut1[indx],
function(x) as.numeric(as.character(x)))
indx <- sapply(books_training_set_mut1,is.integer)
sum(indx)
indx <- sapply(books_training_set_mut1,is.factor)
sum(indx)
lapply(books_training_set_mut1, class)
require(kohonen)
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = books_training_set_mut1, grid = som_grid )
training_data <- as.matrix(books_training_set_mut1)
sum(is.na(training_data))
books_training_set[786,1]
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = books_training_set_mut1, grid = som_grid )
lapply(training_data, class)
som_model <- som(data = books_training_set_mut1, grid = som_grid )
x <- scale(books_training_set_mut1)
x
books_training_set_mut1[is.na(training_data)]
is.na(training_data)
books_training_set_mut1[is.nan(training_data),]
books_training_set_mut1[is.nan(training_data)]
is.nan(training_data)
books_training_set_mut1[is.nan(training_data),]
training_data
max(books_training_set_mut1)
max(books_training_set_mut1[,])
max(books_training_set_mut1[,1:20])
books_training_set_mut1[]
max(books_training_set_mut1[])
x <- scale(books_training_set_mut1)
(is.nan(x))
x
setwd('d:/web mining/project')
books <- read.csv('d:/Web Mining/Project/csv_files/book_data.csv')
colnames(books)
books$published
colnames(books)
books$published
books_training_set <- books[,20:43]
books_training_set
sum(is.na(books_training_set))
colnames(books_training_set)
dim(books_training_set)
head(books_training_set_mut1)
x <- scale(books_training_set)
x
training_data <- as.matrix(x)
(is.nan(training_data))
sum(is.nan(training_data))
sum(is.na(training_data))
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = training_data, grid = som_grid )
is.na(x)
c[is.na(x)]
x[is.na(x)]
x[is.na(x)] = 0
x[is.na(x)]
x[is.na(x)]
count(is.na(x))
sum(is.na(x))
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = training_data, grid = som_grid )
is.nan(x)
count(is.nan(x))
sum(is.nan(x))
som_model <- som(data = training_data, grid = som_grid )
sum(is.inf(x))
sum(is.infinite(x))
sum(is.infinite(x))
sum(is.nan(training_data))
sum(is.na(training_data))
sum(is.na(training_data))
training_data <- as.matrix(x)
sum(is.na(training_data))
sum(is.na(training_data))
sum(is.nan(training_data))
sum(is.infinite(training_data))
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = training_data, grid = som_grid )
plot(som_model, type="count")
setwd('d:/web mining/project')
books <- read.csv('d:/Web Mining/Project/csv_files/book_data.csv')
books_training_set <- books[,20:43]
colnames(books_training_set)
books_training_set_mut1<- books_training_set[is.na(books_training_set[,'books.publication_year']) == F,]
dim(books_training_set)
sum(is.na(books_training_set))
x <- scale(books_training_set)
sum(is.na(x))
sum(is.infinite(x))
training_data <- as.matrix(x)
sum(is.infinite(training_data))
sum(is.na(x))
x <- x[-is.na(x)]
sum(is.na(x))
sum(is.infinite(x))
dim(x)
x <- x[-is.na(x)]
sum(is.na(x))
x
training_data <- as.matrix(x)
sum(is.na(training_data))
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = training_data, grid = som_grid )
books_training_data[1,1]
plot(som_model, type="count")
books <- read.csv('d:/Web Mining/Project/csv_files/book_data.csv')
colnames(books)
books <- read.csv('d:/Web Mining/Project/csv_files/book_data.csv')
books <- books[1:dim(books,1),]
books <- books[1:rnum(books)-1,]
books <- books[1:nrow(books)-1,]
colnames(books)
books_training_set <- books[,20:43]
colnames(books_training_set)
books_training_set_mut1$books.publication_year
dim(books_training_set)
sum(is.na(books_training_set))
head(books_training_set_mut1)
books_training_set_mut1 <- books_training_set_mut1[complete.cases(books_training_set_mut1),]
sum(is.na(books_training_set_mut1))
dim(books_training_set_mut1)
dim(books_training_set)
dim(books_training_set)
class(books_training_set_mut1[1,19])
x <- scale(books_training_set)
x <- x[-is.na(x)]
x <- scale(books_training_set)
sum(is.na(x))
dim(x)
training_data <- as.matrix(x)
sum(is.na(training_data))
require(kohonen)
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = training_data, grid = som_grid )
plot(som_model, type="count")
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = training_data, grid = som_grid )
plot(som_model, type="count")
som_model <- som(data = training_data, grid = som_grid )
plot(som_model, type="count")
kc <- kmeans(x, 10)
kc
plot(kc)
setwd('d:/web mining/project')
books <- read.csv('d:/Web Mining/Project/csv_files/book_data.csv')
colnames(books)
books$published
books_training_set <- books[,20:43]
colnames(books_training_set)
books_training_set_mut1<- books_training_set[is.na(books_training_set[,'books.publication_year']) == F,]
sum(is.na(books_training_data))
x <- scale(books_training_set)
sum(is.na(x))
x
dim(x)
sum(is.infinite(x))
training_data <- as.matrix(x)
sum(is.na(training_data))
require(kohonen)
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = training_data, grid = som_grid )
books_training_data[1,1]
plot(som_model, type="count")
kc <- kmeans(x, 10)
kc
training_data$cluster_no = kc
training_data$cluster_no
training_data
x$cluster_no = kc
x$cluster_no
kc$cluster
x$cluster_no = kc$cluster
data$frame(books$isbn,books$title,kc$cluster)
clustered_book_set <- data.frame(books$isbn,books$title,kc$cluster)
clustered_book_set
colnames(clustered_book_set)
clustered_book_set$kc.cluster = 1
clustered_book_set$kc.cluster == 1
clustered_book_set <- data.frame(books$isbn,books$title,kc$cluster)
clustered_book_set$kc.cluster == 1
clustered_book_set[clustered_book_set$kc.cluster == 1,]
clustered_book_set[clustered_book_set$kc.cluster == 1,"books.title"]
som_grid <- somgrid(xdim = 100, ydim=100, topo="hexagonal")
som_model <- som(data = training_data, grid = som_grid,radius = 5 )
setwd('d:/web mining/project')
books <- read.csv('d:/Web Mining/Project/csv_files/book_data.csv')
books <- books[1:nrow(books)-1,]
colnames(books)
books$published
books_training_set <- books[,20:43]
colnames(books_training_set)
sum(is.na(books_training_data))
dim(books_training_set)
class(books_training_set_mut1[1,19])
x <- scale(books_training_set)
sum(is.na(x))
x
dim(x)
sum(is.infinite(x))
training_data <- as.matrix(x)
sum(is.na(training_data))
require(kohonen)
som_grid <- somgrid(xdim = 100, ydim=100, topo="hexagonal")
som_model <- som(data = training_data, grid = som_grid,radius = 5 )
som_grid <- somgrid(xdim = 50, ydim=50, topo="hexagonal")
som_model <- som(data = training_data, grid = som_grid,radius = 5 )
plot(som_model, type="count")
som_model <- som(data = training_data, grid = som_grid,rlen = 1000, n.hood = "circular" )
plot(som_model, type="count")
som_grid <- somgrid(xdim = 20, ydim=20, topo="hexagonal")
som_model <- som(data = training_data, grid = som_grid,rlen = 1000, n.hood = "circular" )
plot(som_model, type="count")
som_model
som_model$codes
kc <- kmeans(x, 10)
clustered_book_set <- data.frame(books$isbn,books$title,kc$cluster)
clustered_book_set[clustered_book_set$kc.cluster == 1,"books.title"]
clustered_book_set <- dist(data.frame(books$isbn,books$title,kc$cluster))
clustered_book_set[clustered_book_set$kc.cluster == 1,"books.title"]
clustered_book_set <- data.frame(books$isbn,books$title,kc$cluster)
clustered_book_set[clustered_book_set$kc.cluster == 1,"books.title"]
books$cluster_number <- kc$cluster
write.csv(books,"clustered_books.csv")
source('D:/Web Mining/Project/data_clensing.R')
